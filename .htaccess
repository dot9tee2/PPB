# Enable Rewrite Engine
Options +FollowSymLinks
RewriteEngine On

# Remove .php extension from URLs
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME}\.php -f
RewriteRule ^(.+)$ $1.php [NC,L]

# Block direct access to admin.php & edit_property.php
RewriteCond %{REQUEST_URI} ^/admin\.php [NC,OR]
RewriteCond %{REQUEST_URI} ^/edit_property\.php [NC]
RewriteRule ^ - [F,L]  # Return 403 Forbidden

# Allow access via secret URLs
RewriteRule ^secure-admin-panel$ admin.php [L]
RewriteRule ^manage-properties$ edit_property.php [L]

# Set index.php as the default page
DirectoryIndex index.php

# Prevent direct access to .htaccess
<Files ".htaccess">
Order Allow,Deny
Deny from all
</Files>
